2025-05-30 11:33:32,878 [INFO] [root] Logging configurado. Archivo de log: logs\2025-05-30\2025-05-30_11-33-32.log
2025-05-30 11:33:32,879 [INFO] [main] Inicio del programa principal
2025-05-30 11:33:32,880 [INFO] [main] Inicio del proceso de evaluación del chatbot.
2025-05-30 11:33:32,880 [INFO] [main] Generando combinaciones de parámetros desde: configs/settings_ranges.yaml
2025-05-30 11:33:32,887 [INFO] [main] Cargando combinaciones de parámetros desde archivo YAML: configs/settings_ranges.yaml
2025-05-30 11:33:32,888 [INFO] [main] Se generaron 3 combinaciones de parámetros.
2025-05-30 11:33:32,894 [INFO] [change_settings] Inicio actualización settings de Web App 'ChatRic' en RG 'openAI', en subscription 'b29c9dac-08df-4427-9ddb-d50fca7bc22f'
2025-05-30 11:33:32,895 [INFO] [azure.identity._credentials.environment] No environment configuration found.
2025-05-30 11:33:32,897 [INFO] [azure.identity._credentials.managed_identity] ManagedIdentityCredential will use IMDS
2025-05-30 11:33:32,898 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=REDACTED&resource=REDACTED'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-05-30 11:33:34,718 [INFO] [azure.identity._credentials.chained] DefaultAzureCredential acquired a token from AzureCliCredential
2025-05-30 11:33:34,718 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings/list?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '27394b1c-3d39-11f0-90ed-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-30 11:33:35,735 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '59e8b9fc-de87-420b-a3d1-83d1cf502ae3'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-resource-requests': '11999'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 7D6D780BCD54402284BD0E743784E757 Ref B: VIEEDGE3307 Ref C: 2025-05-30T09:33:35Z'
    'Date': 'Fri, 30 May 2025 09:33:35 GMT'
2025-05-30 11:33:35,737 [INFO] [change_settings] Configuración actual obtenida correctamente.
2025-05-30 11:33:35,738 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings?api-version=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Type': 'application/json'
    'Content-Length': '2586'
    'Accept': 'application/json'
    'x-ms-client-request-id': '28eaa727-3d39-11f0-928c-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-05-30 11:33:36,892 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'ETag': '"1DBD145AEBF8FE0"'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': 'ca072730-c376-4c46-96eb-52922ad67786'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-writes': '199'
    'x-ms-ratelimit-remaining-subscription-global-writes': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: B900D0D1B3C24E37B35C53A5833FE653 Ref B: VIEEDGE3307 Ref C: 2025-05-30T09:33:35Z'
    'Date': 'Fri, 30 May 2025 09:33:36 GMT'
2025-05-30 11:33:36,893 [INFO] [change_settings] Nueva configuración aplicada correctamente.
2025-05-30 11:33:36,894 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/restart?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '299afe57-3d39-11f0-bfa4-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-30 11:33:37,811 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': 'c3468737-2dfc-4334-a009-7399eb1adeed'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-writes': '199'
    'x-ms-ratelimit-remaining-subscription-global-writes': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: E31516CCD09A409F981EFCC6997FA3C8 Ref B: VIEEDGE3307 Ref C: 2025-05-30T09:33:37Z'
    'Date': 'Fri, 30 May 2025 09:33:37 GMT'
    'Content-Length': '0'
2025-05-30 11:33:37,812 [INFO] [change_settings] Solicitud de reinicio enviada.
2025-05-30 11:33:37,812 [INFO] [change_settings] Esperando a que la Web App esté en estado 'Running' (máximo 10 intentos)...
2025-05-30 11:33:42,814 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '2d22613e-3d39-11f0-a908-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-30 11:33:43,234 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '8652'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'ETag': '"1DBD145EB379A80"'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '9bacf92e-5e55-4e54-a04e-23c4115e1db8'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-reads': '249'
    'x-ms-ratelimit-remaining-subscription-global-reads': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 1FE66F08941D40378C0C3C83CD440C94 Ref B: VIEEDGE3307 Ref C: 2025-05-30T09:33:43Z'
    'Date': 'Fri, 30 May 2025 09:33:42 GMT'
2025-05-30 11:33:43,236 [INFO] [change_settings] La Web App está en estado 'Running'.
2025-05-30 11:33:43,237 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings/list?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '2d62e333-3d39-11f0-a520-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-30 11:33:43,716 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '76981e99-8933-4422-ac9f-6471cbfa34f7'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-resource-requests': '11999'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: E3B3C42AB1A54A6EB02E677787D5D9FB Ref B: VIEEDGE3307 Ref C: 2025-05-30T09:33:43Z'
    'Date': 'Fri, 30 May 2025 09:33:43 GMT'
2025-05-30 11:33:48,181 [INFO] [loader] Latencia: 2.769 s
2025-05-30 11:33:48,183 [INFO] [evaluator] [cl1] Creando QAEvaluator con model_config...
2025-05-30 11:33:48,199 [INFO] [evaluator] [cl1] QAEvaluator creado correctamente. Iniciando evaluación...
2025-05-30 11:33:49,471 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:50,982 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:51,166 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:51,262 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:51,685 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:51,689 [INFO] [evaluator] [cl1] Evaluación completada correctamente.
2025-05-30 11:33:51,690 [INFO] [main] [INFO] Cargando pesos de métricas desde: configs/metric_weights.yaml
2025-05-30 11:33:51,708 [INFO] [main] Pregunta cl1 evaluada: 4.4 para la etiqueta 'close_question'
2025-05-30 11:33:57,579 [INFO] [loader] Latencia: 2.753 s
2025-05-30 11:33:57,580 [INFO] [evaluator] [te2] Creando QAEvaluator con model_config...
2025-05-30 11:33:57,591 [INFO] [evaluator] [te2] QAEvaluator creado correctamente. Iniciando evaluación...
2025-05-30 11:33:58,508 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:33:59,887 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:00,192 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:00,370 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:01,088 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:01,093 [INFO] [evaluator] [te2] Evaluación completada correctamente.
2025-05-30 11:34:01,095 [INFO] [main] Pregunta te2 evaluada: 3.2 para la etiqueta 'technical_precision'
2025-05-30 11:34:09,083 [INFO] [loader] Latencia: 3.755 s
2025-05-30 11:34:09,089 [INFO] [evaluator] [am3] Creando QAEvaluator con model_config...
2025-05-30 11:34:09,100 [INFO] [evaluator] [am3] QAEvaluator creado correctamente. Iniciando evaluación...
2025-05-30 11:34:10,005 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:11,511 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:11,537 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:11,600 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:11,843 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:11,846 [INFO] [evaluator] [am3] Evaluación completada correctamente.
2025-05-30 11:34:11,846 [INFO] [main] Pregunta am3 evaluada: 3.8 para la etiqueta 'ambiguous_or_error_handling'
2025-05-30 11:34:17,945 [INFO] [loader] Latencia: 2.593 s
2025-05-30 11:34:17,948 [INFO] [evaluator] [co4] Creando QAEvaluator con model_config...
2025-05-30 11:34:17,960 [INFO] [evaluator] [co4] QAEvaluator creado correctamente. Iniciando evaluación...
2025-05-30 11:34:18,902 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:20,206 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:20,331 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:21,737 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:47,390 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-30 11:34:47,392 [INFO] [evaluator] [co4] Evaluación completada correctamente.
2025-05-30 11:34:47,393 [INFO] [main] Pregunta co4 evaluada: 2.4 para la etiqueta 'comparison_standards'
2025-05-30 11:34:47,394 [ERROR] [main] Error en la ejecución principal: 'id'
Traceback (most recent call last):
  File "C:\Users\CASTILLOEMILYGABRIEL\OneDrive - TK Elevator\Documentos\chatbot_evaluation\app\main.py", line 280, in main
    combinations_pending = [c for c in combinations_pending if c["id"] != count]
                                                               ~^^^^^^
KeyError: 'id'

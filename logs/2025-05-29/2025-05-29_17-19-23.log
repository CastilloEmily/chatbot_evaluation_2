2025-05-29 17:19:23,257 [INFO] [root] Logging configurado. Archivo de log: logs\2025-05-29\2025-05-29_17-19-23.log
2025-05-29 17:19:23,258 [INFO] [main] Inicio del programa principal
2025-05-29 17:19:23,258 [INFO] [main] Inicio del proceso de evaluación del chatbot.
2025-05-29 17:19:23,258 [INFO] [main] Cargando combinaciones pendientes desde archivo: data/combinations\combinations_pending.json
2025-05-29 17:19:23,259 [INFO] [change_settings] Inicio actualización settings de Web App 'ChatRic' en RG 'openAI', en subscription 'b29c9dac-08df-4427-9ddb-d50fca7bc22f'
2025-05-29 17:19:23,259 [INFO] [azure.identity._credentials.environment] No environment configuration found.
2025-05-29 17:19:23,270 [INFO] [azure.identity._credentials.managed_identity] ManagedIdentityCredential will use IMDS
2025-05-29 17:19:23,270 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=REDACTED&resource=REDACTED'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.23.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
No body was attached to the request
2025-05-29 17:19:24,047 [INFO] [azure.identity._credentials.chained] DefaultAzureCredential acquired a token from AzureCliCredential
2025-05-29 17:19:24,047 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings/list?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '4cff1cf1-3ca0-11f0-aa78-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-29 17:19:25,279 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '96023384-4c1c-447a-a8ec-a5b6db165652'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-resource-requests': '11999'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 870F66707CF844B98769E2C5A7164DA6 Ref B: AMS231032607049 Ref C: 2025-05-29T15:19:24Z'
    'Date': 'Thu, 29 May 2025 15:19:25 GMT'
2025-05-29 17:19:25,280 [INFO] [change_settings] Configuración actual obtenida correctamente.
2025-05-29 17:19:25,282 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings?api-version=REDACTED'
Request method: 'PUT'
Request headers:
    'Content-Type': 'application/json'
    'Content-Length': '2586'
    'Accept': 'application/json'
    'x-ms-client-request-id': '4e321215-3ca0-11f0-948f-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-05-29 17:19:26,751 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'ETag': '"1DBD0AC271A0FD5"'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '28be4f35-c6d1-4d9b-ac2b-882eb5a6f0c5'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-writes': '199'
    'x-ms-ratelimit-remaining-subscription-global-writes': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 3BF646A0D8F3440FB7EBA94C187FC2F3 Ref B: AMS231032607049 Ref C: 2025-05-29T15:19:25Z'
    'Date': 'Thu, 29 May 2025 15:19:26 GMT'
2025-05-29 17:19:26,752 [INFO] [change_settings] Nueva configuración aplicada correctamente.
2025-05-29 17:19:26,752 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/restart?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '4f1267ff-3ca0-11f0-a071-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-29 17:19:27,131 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '7663366c-908a-4298-86a0-509b8c87fb02'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-writes': '198'
    'x-ms-ratelimit-remaining-subscription-global-writes': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 27D867CACE34460BA8AD2B20D4B4D6C6 Ref B: AMS231032607049 Ref C: 2025-05-29T15:19:26Z'
    'Date': 'Thu, 29 May 2025 15:19:27 GMT'
    'Content-Length': '0'
2025-05-29 17:19:27,131 [INFO] [change_settings] Solicitud de reinicio enviada.
2025-05-29 17:19:27,132 [INFO] [change_settings] Esperando a que la Web App esté en estado 'Running' (máximo 10 intentos)...
2025-05-29 17:19:32,133 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '52478070-3ca0-11f0-934b-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-29 17:19:32,649 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '8652'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'ETag': '"1DBD0AD10A797A0"'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': 'cf121eb5-6008-4757-aeb4-9d63b486e383'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-reads': '249'
    'x-ms-ratelimit-remaining-subscription-global-reads': 'REDACTED'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: 15260A1C9E754DE688FDD6191B9E6808 Ref B: AMS231032607049 Ref C: 2025-05-29T15:19:32Z'
    'Date': 'Thu, 29 May 2025 15:19:32 GMT'
2025-05-29 17:19:32,652 [INFO] [change_settings] La Web App está en estado 'Running'.
2025-05-29 17:19:32,653 [INFO] [azure.core.pipeline.policies.http_logging_policy] Request URL: 'https://management.azure.com/subscriptions/b29c9dac-08df-4427-9ddb-d50fca7bc22f/resourceGroups/openAI/providers/Microsoft.Web/sites/ChatRic/config/appsettings/list?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-ms-client-request-id': '5296dc5c-3ca0-11f0-b01d-24eb1694bf2d'
    'User-Agent': 'azsdk-python-azure-mgmt-web/8.0.0 Python/3.13.3 (Windows-11-10.0.26100-SP0)'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-05-29 17:19:33,419 [INFO] [azure.core.pipeline.policies.http_logging_policy] Response status: 200
Response headers:
    'Cache-Control': 'no-cache'
    'Pragma': 'no-cache'
    'Content-Length': '2708'
    'Content-Type': 'application/json'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'x-ms-request-id': '1871d691-1066-4418-929f-d662b7a18d1e'
    'X-AspNet-Version': 'REDACTED'
    'X-Powered-By': 'REDACTED'
    'x-ms-operation-identifier': 'REDACTED'
    'x-ms-ratelimit-remaining-subscription-resource-requests': '11998'
    'x-ms-correlation-request-id': 'REDACTED'
    'x-ms-routing-request-id': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'X-Cache': 'REDACTED'
    'X-MSEdge-Ref': 'Ref A: BE2EFE3200854BEDA31D1CD24B463374 Ref B: AMS231032607049 Ref C: 2025-05-29T15:19:32Z'
    'Date': 'Thu, 29 May 2025 15:19:33 GMT'
2025-05-29 17:19:38,676 [INFO] [loader] Latencia: 3.377 s
2025-05-29 17:19:38,678 [INFO] [evaluator] [cl1] Creando QAEvaluator con model_config...
2025-05-29 17:19:38,725 [INFO] [evaluator] [cl1] QAEvaluator creado correctamente. Iniciando evaluación...
2025-05-29 17:19:40,537 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-29 17:19:41,573 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-29 17:19:41,916 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-29 17:19:42,686 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-29 17:19:42,727 [INFO] [httpx] HTTP Request: POST https://ea-shared-ai-serviceplan-01-prod.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-05-29 17:19:42,730 [INFO] [evaluator] [cl1] Evaluación completada correctamente.
2025-05-29 17:19:42,730 [INFO] [main] [INFO] Cargando pesos de métricas desde: configs/metric_weights.yaml
2025-05-29 17:19:42,747 [INFO] [main] Pregunta cl1 evaluada: 4.2 para la etiqueta 'close_question'
